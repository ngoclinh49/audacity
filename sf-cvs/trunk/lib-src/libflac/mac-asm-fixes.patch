Index: lib-src/libflac/configure.in
===================================================================
RCS file: /cvsroot/audacity/lib-src/libflac/configure.in,v
retrieving revision 1.3
diff -u -r1.3 configure.in
--- lib-src/libflac/configure.in	13 Feb 2006 11:53:01 -0000	1.3
+++ lib-src/libflac/configure.in	12 Jan 2008 17:26:54 -0000
@@ -52,6 +52,7 @@
 AM_CONDITIONAL(FLaC__CPU_SPARC, test x$cpu_sparc = xtrue)
 case "$host" in
 	i386-*-openbsd3.[[0-3]]) OBJ_FORMAT=aoutb ;;
+	*-*-darwin*) OBJ_FORMAT=macho ;;
 	*) OBJ_FORMAT=elf ;;
 esac
 AC_SUBST(OBJ_FORMAT)
Index: lib-src/libflac/src/libFLAC/ia32/nasm.h
===================================================================
RCS file: /cvsroot/audacity/lib-src/libflac/src/libFLAC/ia32/nasm.h,v
retrieving revision 1.2
diff -u -r1.2 nasm.h
--- lib-src/libflac/src/libFLAC/ia32/nasm.h	13 Feb 2006 11:36:45 -0000	1.2
+++ lib-src/libflac/src/libFLAC/ia32/nasm.h	12 Jan 2008 17:26:55 -0000
@@ -49,6 +49,11 @@
 	%idefine code_section section .text align=16
 	%idefine data_section section .data align=32
 	%idefine bss_section  section .bss  align=32
+%elifdef OBJ_FORMAT_macho
+	%define FLAC__PUBLIC_NEEDS_UNDERSCORE
+	%idefine code_section section .text
+	%idefine data_section section .data
+	%idefine bss_section  section .bss
 %else
 	%error unsupported object format!
 %endif
