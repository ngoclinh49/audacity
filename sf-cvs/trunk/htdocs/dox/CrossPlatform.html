<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Audacity: Cross Platform Coding Tips</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1><a class="anchor" name="CrossPlatform">Cross Platform Coding Tips </a></h1>Guidelines for making the code compile and work on all supported platforms.<h2><a class="anchor" name="PragmaOnce">
#pragma once</a></h2>
The following is not supported under gcc 2.x:<p>
<div class="fragment"><pre class="fragment"><span class="comment">// WRONG</span>
<span class="preprocessor">#pragma once</span>
</pre></div><p>
Instead use the traditional:<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#ifndef __AUDACITY_HEADER_FILE_NAME__</span>
<span class="preprocessor"></span><span class="preprocessor">#define __AUDACITY_HEADER_FILE_NAME__</span>
<span class="preprocessor"></span>
<span class="comment">// your header file contents goes here.</span>

<span class="preprocessor">#endif</span>
</pre></div><h2><a class="anchor" name="UnicodeStrings">
Unicode strings</a></h2>
Audacity code is translated, and it may be built in Unicode versions. For this reason all strings should be wrapped like this:<p>
<div class="fragment"><pre class="fragment">   <span class="comment">// for strings which are not translated</span>
   mMyFirstString = wxT(<span class="stringliteral">"some untranslated string"</span>);
   <span class="comment">// for strings which should be translated</span>
   mMySecondString = _(<span class="stringliteral">"some translatable string"</span>);
</pre></div><p>
In some cases you need to give hints to a translator about how a string should be translated. Do so as follows:<p>
<p>
<div class="fragment"><pre class="fragment">   <span class="comment">/* i18n-hint: One-letter abbreviation for Left, in VU Meter */</span>
   mLeftText = _(<span class="stringliteral">"L"</span>);
   <span class="comment">/* i18n-hint: One-letter abbreviation for Right, in VU Meter */</span>
   mRightText = _(<span class="stringliteral">"R"</span>);
</pre></div><p>
Very long strings can be wrapped across multiple lines, as follows:<p>
<div class="fragment"><pre class="fragment">   <span class="comment">// For untranslated strings:</span>
   wxT(<span class="stringliteral">"This is a long untranslated string "</span>)
   wxT("which spans several lines ")
   wxT("and works in Unicode builds too")

   <span class="comment">// For translated strings:</span>
   _("This is a <span class="keywordtype">long</span> translated <span class="keywordtype">string</span> "
   wxT("which spans several lines ")
   wxT("and works in Unicode builds too"))
</pre></div><p>
Notice that in the translated example, all bar the first substring are contained within a <code>wxT()</code>.<h2><a class="anchor" name="ConstructorsAsArguments">
Constructors as Arguments</a></h2>
Don't write code like this:<p>
<div class="fragment"><pre class="fragment">   <span class="comment">// WRONG</span>
   <span class="comment">// Now call OnSampleRateChange to update the values.</span>
   OnSampleRateChange( wxCommandEvent() );
</pre></div><p>
Whilst it is fine under MSVC it will cause a problem under gcc as the constructor is a temporary object which will be optimised away.<p>
Instead use:<p>
<div class="fragment"><pre class="fragment">   <span class="comment">// Now call OnSampleRateChange to update the values.</span>
   wxCommandEvent e;
   OnSampleRateChange( e );
</pre></div><h2><a class="anchor" name="HeaderFiles">
Header Files</a></h2>
Windows systems are not case sensitive, whilst Linux systems are. You therefore need to take care in capitalisation, e.g:<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include "<a class="code" href="AttachableScrollBar_8h.html">AttachableScrollBar.h</a>"</span>
</pre></div><h2><a class="anchor" name="ClassNamesInClasses">
Class Names in Classes</a></h2>
Microsoft Visual C++ allows you to write code like this in a header file:<p>
<div class="fragment"><pre class="fragment"><span class="comment">// WRONG</span>
<span class="keyword">class </span>MyClass 
{
<span class="keyword">public</span>:
   <span class="keywordtype">int</span> MyClass::SomeFunction();
   <span class="comment">//... other stuff</span>
</pre></div><p>
For portability, the <code>'MyClass</code>::' prefix should be left out.<h2><a class="anchor" name="wxStringInFormat">
Using wxString in Format</a></h2>
Don't write code like this:<p>
<div class="fragment"><pre class="fragment">   wxString Message( wxT(<span class="stringliteral">"Hello"</span> )); 
   <span class="comment">// WRONG</span>
   wxString Temp = wxString::Format(wxT(<span class="stringliteral">"Your said %s in your message"</span>), Message );
</pre></div><p>
Although MSVC won't complain even in Unicode mode, it generates a warning under gcc. Instead you need:<p>
<div class="fragment"><pre class="fragment">   wxString Message( wxT(<span class="stringliteral">"Hello"</span> )); 
   wxString Temp = wxString::Format(wxT(<span class="stringliteral">"Your said %s in your message"</span>), Message.c_str() );
</pre></div><h2><a class="anchor" name="ForwardEnums">
Forward Declared Enums</a></h2>
Microsoft Visual C++ allows you to write code like this in a header file:<p>
<div class="fragment"><pre class="fragment"><span class="comment">// WRONG</span>
<span class="keyword">enum</span> MyEnum;
</pre></div><p>
That is, you can forward declare an enum just as you can forward declare a class. This is not portable. The alternative is to include a header file containing the full enum definition.<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include "MyEnum.h"</span>
</pre></div> <hr size="1"><address style="text-align: right;"><small>Generated on Sat Oct 11 21:08:36 2008 for Audacity by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
