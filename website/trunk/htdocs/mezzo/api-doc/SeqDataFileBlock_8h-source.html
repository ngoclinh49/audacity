<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Mezzo: SeqDataFileBlock.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>SeqDataFileBlock.h</h1><a href="SeqDataFileBlock_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/**********************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment">  Mezzo: A Cross-Platform Audio Editing Engine</span>
00004 <span class="comment"></span>
00005 <span class="comment">  SeqDataFileBlock.h</span>
00006 <span class="comment"></span>
00007 <span class="comment">  Copyright (c) 2004 Joshua Haberman</span>
00008 <span class="comment"></span>
00009 <span class="comment">  This program is free software and comes with no warranty; for more</span>
00010 <span class="comment">  information, see the file LICENSE.txt or visit</span>
00011 <span class="comment">  http://audacity.sourceforge.net/mezzo/license/</span>
00012 <span class="comment"></span>
00013 <span class="comment">**********************************************************************/</span>
00014 
00015 <span class="preprocessor">#include &lt;string&gt;</span>
00016 
00017 <span class="preprocessor">#include "<a class="code" href="SeqBlock_8h.html">SeqBlock.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="ManagedFile_8h.html">ManagedFile.h</a>"</span>
00019 
00020 <span class="keyword">namespace </span>Mezzo {
00021 
00022 <span class="keyword">class </span>SeqDataFileBlock;
00023 
<a name="l00024"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html">00024</a> <span class="keyword">class </span><a class="code" href="classMezzo_1_1SeqDataFileBlock.html">SeqDataFileBlock</a> : <span class="keyword">public</span> <a class="code" href="classMezzo_1_1SeqBlock.html">SeqBlock</a>, <span class="keyword">public</span> <a class="code" href="classMezzo_1_1ManagedFile.html">ManagedFile</a>
00025 {
00026  <span class="keyword">public</span>:
00027    <span class="comment">// Construction is not complete until you give it a buffer to write</span>
00028    <span class="comment">// using one of the following two methods</span>
00029    <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a0">SeqDataFileBlock</a>(std::string fullPathName, std::string fileName, <a class="code" href="classMezzo_1_1Buffer.html">Buffer</a> data);
00030 
00031    <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a0">SeqDataFileBlock</a>(<a class="code" href="classMezzo_1_1Loader.html">Loader</a>&amp; loader, std::string absDir);
00032 <span class="comment"></span>
00033 <span class="comment">   /// Retrieves audio data from this BlockFile</span>
00034 <span class="comment"></span>   <a class="code" href="classMezzo_1_1Buffer.html">Buffer</a> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a2">Get</a>(<span class="keywordtype">int</span> start = 0);<span class="comment"></span>
00035 <span class="comment">   /// Retrieves audio data from this BlockFile</span>
00036 <span class="comment"></span>   <a class="code" href="classMezzo_1_1Buffer.html">Buffer</a> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a2">Get</a>(<span class="keywordtype">int</span> start, <span class="keywordtype">int</span> len);
00037 <span class="comment"></span>
00038 <span class="comment">   /// Same functions as above, but to be used for GUI drawing when</span>
00039 <span class="comment">   /// it's okay to defer and get the data later</span>
00040 <span class="comment"></span>   <span class="keywordtype">bool</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a4">GetIfCached</a>(<a class="code" href="classMezzo_1_1Buffer.html">Buffer</a> &amp;buf, <span class="keywordtype">int</span> start = 0);
00041    <span class="keywordtype">bool</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a4">GetIfCached</a>(<a class="code" href="classMezzo_1_1Buffer.html">Buffer</a> &amp;buf, <span class="keywordtype">int</span> start, <span class="keywordtype">int</span> len);
00042 
<a name="l00043"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a6">00043</a>    <span class="keywordtype">float</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a6">GetMin</a>() { <span class="keywordflow">return</span> mMin; }
<a name="l00044"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a7">00044</a>    <span class="keywordtype">float</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a7">GetMax</a>() { <span class="keywordflow">return</span> mMax; }
<a name="l00045"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a8">00045</a>    <span class="keywordtype">float</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a8">GetSumSq</a>() { <span class="keywordflow">return</span> mSumSq; }
00046 
00047    <a class="code" href="classMezzo_1_1SeqBlockSummary.html">SeqBlockSummary</a> *<a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a9">GetSummary</a>();
00048    <span class="keywordtype">bool</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a10">GetSummaryIfCached</a>(<a class="code" href="classMezzo_1_1SeqBlockSummary.html">SeqBlockSummary</a> **summary);
00049 
<a name="l00050"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a11">00050</a>    <span class="keywordtype">void</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a11">IncrementDataReadRequestCount</a>() { mCachedBufferData.IncrementReadRequestCount(); }
<a name="l00051"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a12">00051</a>    <span class="keywordtype">void</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a12">DecrementDataReadRequestCount</a>() { mCachedBufferData.DecrementReadRequestCount(); }
<a name="l00052"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a13">00052</a>    <span class="keywordtype">void</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a13">IncrementSummaryReadRequestCount</a>() { mCachedMetaData.IncrementReadRequestCount(); }
<a name="l00053"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a14">00053</a>    <span class="keywordtype">void</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a14">DecrementSummaryReadRequestCount</a>() { mCachedMetaData.DecrementReadRequestCount(); }
00054 
00055    <a class="code" href="classMezzo_1_1ManagedFile.html">ManagedFile</a> *<a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a15">Copy</a>(std::string fileName);
00056 
00057    <span class="keywordtype">int</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a16">GetRAMBytesUsed</a>();
00058    <span class="keywordtype">int</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a17">GetDiskBytesUsed</a>();
00059 
00060    <span class="keywordtype">void</span> <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#a18">Store</a>(<a class="code" href="classMezzo_1_1Storer.html">Storer</a>&amp; storer);
00061 
<a name="l00062"></a><a class="code" href="classMezzo_1_1SeqDataFileBlock.html#e0">00062</a>    <span class="keyword">static</span> std::string <a class="code" href="classMezzo_1_1SeqDataFileBlock.html#e0">GetExtension</a>() { <span class="keywordflow">return</span> <span class="stringliteral">"au"</span>; }
00063 
00064  <span class="keyword">private</span>:
00065    <span class="keyword">class </span>CachedBufferData : <span class="keyword">public</span> <a class="code" href="classMezzo_1_1CachedDiskData.html">CachedDiskData</a>
00066    {
00067       CachedBufferData(<a class="code" href="classMezzo_1_1SeqDataFileBlock.html">SeqDataFileBlock</a> *b): block(b) { }
00068 
00069       SeqDataFileBlock *block;
00070       Buffer data;
00071 
00072       <span class="keywordtype">void</span> <a class="code" href="classMezzo_1_1Storable.html#e0">Load</a>() { data = block-&gt;<a class="code" href="classMezzo_1_1Buffer.html#a12">Get</a>(); }
00073       <span class="keywordtype">void</span> Unload() { data = FloatBuffer(0); }
00074 
00075       <span class="keyword">friend</span> <span class="keyword">class </span>SeqDataFileBlock;
00076    }mCachedBufferData;
00077 
00078    <span class="keyword">class </span>CachedMetaData : <span class="keyword">public</span> CachedDiskData
00079    {
00080       CachedMetaData(SeqDataFileBlock *b): block(b) { }
00081 
00082       SeqDataFileBlock *block;
00083       SeqBlockSummary *summary;
00084 
00085       <span class="keywordtype">void</span> <a class="code" href="classMezzo_1_1Storable.html#e0">Load</a>() { summary = block-&gt;GetSummary(); }
00086       <span class="keywordtype">void</span> Unload() { summary = NULL; }
00087 
00088       <span class="keyword">friend</span> <span class="keyword">class </span>SeqDataFileBlock;
00089    }mCachedMetaData;
00090 
00091    std::vector&lt;CachedDiskData*&gt; <a class="code" href="classMezzo_1_1ManagedFile.html#b0">GetCacheObjects</a>()
00092    {
00093       std::vector&lt;CachedDiskData*&gt; objects;
00094       objects.push_back(&amp;mCachedBufferData);
00095       objects.push_back(&amp;mCachedMetaData);
00096       <span class="keywordflow">return</span> objects;
00097    }
00098 
00099 
00100    <span class="keywordtype">float</span>  mMin;
00101    <span class="keywordtype">float</span>  mMax;
00102    <span class="keywordtype">float</span>  mSumSq;
00103 };
00104 
00105 
00106 } <span class="comment">// namespace</span>
00107 
00108 <span class="comment">// Indentation settings for Vim and Emacs.  Please do not modify past this point.</span>
00109 <span class="comment">//</span>
00110 <span class="comment">// Local Variables:</span>
00111 <span class="comment">// c-basic-offset: 3</span>
00112 <span class="comment">// indent-tabs-mode: nil</span>
00113 <span class="comment">// End:</span>
00114 <span class="comment">//</span>
00115 <span class="comment">// vim: et sts=3 sw=3</span>
00116 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri May 19 20:42:23 2006 for Mezzo by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
